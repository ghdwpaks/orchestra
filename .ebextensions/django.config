option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: orchestra/wsgi.py  # WSGI 파일 경로를 Django 프로젝트에 맞게 설정
    NumProcesses: 1              # 동시 프로세스 수 (적절히 조정 가능)
    NumThreads: 8                # 스레드 수 (적절히 조정 가능)

  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: "orchestra.settings.production"
    PYTHONPATH: "/opt/python/current/app"

packages:
  yum:
    git: []  # git을 yum으로 설치 (필요 시)

container_commands:
  01_migrate:
    command: "python3 manage.py migrate --noinput"
    leader_only: true  # 한 번만 실행
  02_collectstatic:
    command: "python3 manage.py collectstatic --noinput"
    leader_only: true
  03_check_health:
    command: "curl -f http://localhost:8000 || exit 1"
    leader_only: true